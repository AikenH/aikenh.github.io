<!doctype html>
<html lang="cn"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>StableDiffusionWebUI鉴权设计 - AikenH Blogs</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Aiken Hong"><meta name="msapplication-TileImage" content="/img/pokemon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Aiken Hong"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="[&amp;gt; [!summary]+  this article purpose is to build an authority page for stable diffusion webui using nginx &amp;amp; python&amp;#x2F;js. Which can publish my personal stable diffusion server. Wrote by GPT(try)."><meta property="og:type" content="blog"><meta property="og:title" content="StableDiffusionWebUI鉴权设计"><meta property="og:url" content="http://aikenh.cn/cn/StableDiffusionWebUI%E9%89%B4%E6%9D%83%E8%AE%BE%E8%AE%A1/"><meta property="og:site_name" content="AikenH Blogs"><meta property="og:description" content="[&amp;gt; [!summary]+  this article purpose is to build an authority page for stable diffusion webui using nginx &amp;amp; python&amp;#x2F;js. Which can publish my personal stable diffusion server. Wrote by GPT(try)."><meta property="og:locale" content="cn"><meta property="og:image" content="http://aikenh.cn/img/header_img/lml_bg1.jpg"><meta property="article:published_time" content="2023-12-08T07:42:36.000Z"><meta property="article:modified_time" content="2024-01-27T09:13:23.751Z"><meta property="article:author" content="AikenH"><meta property="article:tag" content="AI"><meta property="article:tag" content="AIGC"><meta property="article:tag" content="Web"><meta property="article:tag" content="Flask"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://aikenh.cn/img/header_img/lml_bg1.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://aikenh.cn/cn/StableDiffusionWebUI%E9%89%B4%E6%9D%83%E8%AE%BE%E8%AE%A1/"},"headline":"StableDiffusionWebUI鉴权设计","image":["http://aikenh.cn/img/header_img/lml_bg1.jpg"],"datePublished":"2023-12-08T07:42:36.000Z","dateModified":"2024-01-27T09:13:23.751Z","author":{"@type":"Person","name":"AikenH"},"publisher":{"@type":"Organization","name":"AikenH Blogs","logo":{"@type":"ImageObject","url":{"text":"Aiken's Blog"}}},"description":"[&gt; [!summary]+  this article purpose is to build an authority page for stable diffusion webui using nginx &amp; python&#x2F;js. Which can publish my personal stable diffusion server. Wrote by GPT(try)."}</script><link rel="canonical" href="http://aikenh.cn/cn/StableDiffusionWebUI%E9%89%B4%E6%9D%83%E8%AE%BE%E8%AE%A1/"><link rel="icon" href="/img/pokemon.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-dark.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css" title="default"><link rel="alternate stylesheet" href="/css/cyberpunk.css" title="cyberpunk"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="AikenH Blogs" type="application/atom+xml">
</head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">Aiken&#039;s Blog</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/AikenH"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a><a class="navbar-item night" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-lightbulb" id="night-icon"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><div class="card"><div class="card-image"><span class="image is-7by3"><img class="fill" src="/img/header_img/lml_bg1.jpg" alt="StableDiffusionWebUI鉴权设计"></span></div><article class="card-content article" role="article"><h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal"><i class="fas fa-angle-double-right"></i>StableDiffusionWebUI鉴权设计</h1><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><i class="far fa-calendar-alt"> </i><time dateTime="2023-12-08T07:42:36.000Z" title="2023-12-08T07:42:36.000Z">2023-12-08</time></span><span class="level-item">Updated&nbsp;<time dateTime="2024-01-27T09:13:23.751Z" title="2024/1/27 17:13:23">2024-01-27</time></span><span class="level-item"><a class="link-muted" href="/categories/Machine-Learning/">Machine Learning</a><span> / </span><a class="link-muted" href="/categories/Machine-Learning/AIGC/">AIGC</a></span><span class="level-item">15 minutes read (About 2324 words)</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>&nbsp;visits</span></div></div><div class="content"><p>[&gt; [!summary]+</p>
<blockquote>
<p>this article purpose is to build an authority page for stable diffusion webui using nginx &amp; python/js. Which can publish my personal stable diffusion server. Wrote by GPT(try).</p>
</blockquote>
<p><img src="https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20240127161828.png" alt="image.png"></p>
<h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h3><p>In the digital age, the security and user-friendliness of web services are not just conveniences; they are necessities. Balancing robust security protocols with an engaging user experience is key to maintaining both the integrity and popularity of any online service. This blog post dives into the intricacies of securing web services using Nginx for authentication, coupled with designing an appealing frontend. Our journey begins with a practical scenario: publishing a stable diffusion webUI service, accessible only to an authenticated audience.</p>
<h3 id="Setting-Up-Nginx-for-Secure-Authentication"><a href="#Setting-Up-Nginx-for-Secure-Authentication" class="headerlink" title="Setting Up Nginx for Secure Authentication"></a>Setting Up Nginx for Secure Authentication</h3><p>Nginx excels in serving web pages and as a reverse proxy, providing enhanced security through authentication mechanisms. Let’s explore a typical Nginx configuration for secure authentication:</p>
<ul>
<li><strong>/verify_token</strong>: This block forwards authentication requests to a dedicated server. By excluding the request body and focusing on essential headers, it ensures that only valid, authenticated requests proceed.</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs conf">location = /verify_token &#123;<br>    proxy_pass http://&#123;your_auth_server&#125;:2424;<br>    proxy_pass_request_body off;<br>    proxy_set_header Content-Length &quot;&quot;;<br>    proxy_set_header X-Original-URI $request_uri;<br>    proxy_set_header X-Original-Remote-Addr $remote_addr;<br>    proxy_set_header X-Original-Host $host;<br>&#125;<br></code></pre></td></tr></table></figure>
<ul>
<li><strong>/login</strong>: Catering to login requests, this configuration forwards the necessary details to the authentication server, preserving crucial information about the request’s origin.</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs conf">location /login &#123;<br>    proxy_pass http://&#123;your_auth_server&#125;:2424;<br>    proxy_set_header Host $host;<br>    proxy_set_header X-Real-IP $remote_addr;<br>    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;<br>    proxy_set_header X-Forwarded-Proto $scheme;<br>&#125;<br></code></pre></td></tr></table></figure>
<ul>
<li><strong>Error Handling (@error401)</strong>: A clever redirect mechanism that guides unauthenticated users to the login page, keeping the original URL intact.</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs conf">location @error401 &#123;<br>    return 302 &#123;your_domain&#125;/login;<br>&#125;<br></code></pre></td></tr></table></figure>
<ul>
<li><strong>Root Location (/)</strong>: The gateway to your service, which rigorously checks each request for authentication, granting access only to verified users.</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs conf">location / &#123;<br>    auth_request /verify_token;<br>    error_page 401 = @error401;<br>    proxy_pass http://&#123;your_server&#125;:2323/;<br>    proxy_http_version 1.1;<br>    proxy_set_header Upgrade $http_upgrade;<br>    proxy_set_header Connection &#x27;upgrade&#x27;;<br>    proxy_set_header Host $host;<br>    proxy_cache_bypass $http_upgrade;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>This setup not only fortifies your service against unauthorized access but also maintains a seamless user experience, redirecting unauthenticated users without hassle.</p>
<span id="more"></span>
<h3 id="Implementing-JWT-for-Robust-Backend-Authentication"><a href="#Implementing-JWT-for-Robust-Backend-Authentication" class="headerlink" title="Implementing JWT for Robust Backend Authentication"></a>Implementing JWT for Robust Backend Authentication</h3><p>Implementing JWT (JSON Web Tokens) in a Flask web application provides a secure way of handling authentication. The provided Flask code demonstrates how JWT can be integrated for a robust backend authentication system:</p>
<ol>
<li><strong>Setup and Environment Variables</strong>:<ul>
<li>The Flask app is configured with a secret key, essential for JWT encoding and decoding.</li>
</ul>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> dotenv <span class="hljs-keyword">import</span> load_dotenv<br><br>load_dotenv()<br>app = Flask(__name__)<br>app.secret_key = os.getenv(<span class="hljs-string">&#x27;SECRET_KEY&#x27;</span>)<br></code></pre></td></tr></table></figure>
<ol>
<li><strong>Login Route</strong>:<ul>
<li>The <code>/login</code> route handles user authentication. Upon successful login, a JWT is encoded with the user’s information and expiration time, then sent as a cookie.</li>
</ul>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/login&#x27;</span>, methods=[<span class="hljs-string">&#x27;POST&#x27;</span>, <span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">login</span>():<br>    count = update_visit_count()<br>    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;POST&#x27;</span>:<br>        username = request.form[<span class="hljs-string">&#x27;username&#x27;</span>]<br>        password = request.form[<span class="hljs-string">&#x27;password&#x27;</span>]<br><br>        <span class="hljs-comment"># Validate credentials (use a secure method in production)</span><br>        <span class="hljs-keyword">if</span> username == os.getenv(<span class="hljs-string">&#x27;chat_username&#x27;</span>) <span class="hljs-keyword">and</span> password == os.getenv(<span class="hljs-string">&#x27;password&#x27;</span>):<br>            token = jwt.encode(&#123;<br>                <span class="hljs-string">&#x27;user&#x27;</span>: username,<br>                <span class="hljs-string">&#x27;exp&#x27;</span>: datetime.datetime.utcnow() + datetime.timedelta(minutes=<span class="hljs-number">30</span>)<br>            &#125;, app.secret_key, algorithm=<span class="hljs-string">&#x27;HS256&#x27;</span>)<br><br>            response = make_response(redirect(<span class="hljs-string">&#x27;/&#x27;</span>))<br>            response.set_cookie(<span class="hljs-string">&#x27;token&#x27;</span>, token, max_age=<span class="hljs-number">1800</span>)  <span class="hljs-comment"># Keep login status for 30 mins</span><br>            <span class="hljs-keyword">return</span> response<br>        <br>        error = <span class="hljs-string">&#x27;Invalid credentials&#x27;</span><br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;login.html&#x27;</span>, error=error, count=count), <span class="hljs-number">401</span><br>    <br>    <span class="hljs-comment"># Show login page</span><br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;login.html&#x27;</span>,count=count)<br></code></pre></td></tr></table></figure>
<ol>
<li><strong>Token Verification</strong>:<ul>
<li>A decorator <code>token_required</code> is used to verify the JWT token in subsequent requests. This ensures that only authenticated users can access certain routes.</li>
</ul>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">token_required</span>(<span class="hljs-params">f</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">decorator</span>(<span class="hljs-params">*args, **kwargs</span>):<br>        token = request.cookies.get(<span class="hljs-string">&#x27;token&#x27;</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> token:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;token is none&#x27;</span>)<br>            <span class="hljs-keyword">return</span> redirect(<span class="hljs-string">&#x27;/login&#x27;</span>)<br>        <span class="hljs-keyword">try</span>:<br>            jwt.decode(token, app.secret_key, algorithms=[<span class="hljs-string">&#x27;HS256&#x27;</span>])<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;token is invalid&#x27;</span>)<br>            <span class="hljs-keyword">return</span> redirect(<span class="hljs-string">&#x27;/login&#x27;</span>)<br>        <span class="hljs-keyword">return</span> f(*args, **kwargs)<br>    decorator.__name__ = f.__name__<br>    <span class="hljs-keyword">return</span> decorator<br></code></pre></td></tr></table></figure>
<ol>
<li><strong>Token Validation Endpoint</strong>:<ul>
<li>The <code>/verify_token</code> endpoint checks the validity of the token, which is essential for integrating with the Nginx authentication mechanism.</li>
</ul>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/verify_token&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">verify_token</span>():<br>    token = request.cookies.get(<span class="hljs-string">&#x27;token&#x27;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> token:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Access Denied&#x27;</span>, <span class="hljs-number">401</span><br><br>    <span class="hljs-keyword">try</span>:<br>        jwt.decode(token, app.secret_key, algorithms=[<span class="hljs-string">&#x27;HS256&#x27;</span>])<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Authorized&#x27;</span>, <span class="hljs-number">200</span><br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Access Denied&#x27;</span>, <span class="hljs-number">401</span><br></code></pre></td></tr></table></figure>
<ol>
<li><strong>Dynamic Secret Key Update</strong>:<ul>
<li>A function <code>update_secret_key_in_env</code> is included to update the secret key daily, enhancing security by invalidating old tokens.</li>
</ul>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Function to generate a new secret key and write it to the .env file</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">update_secret_key_in_env</span>():<br>    env_file_path = <span class="hljs-string">&#x27;.env&#x27;</span><br>    secret_key = <span class="hljs-string">f&#x27;SECRET_KEY=<span class="hljs-subst">&#123;secrets.token_urlsafe(<span class="hljs-number">32</span>)&#125;</span>&#x27;</span><br>    last_updated = <span class="hljs-string">f&#x27;LAST_UPDATED=<span class="hljs-subst">&#123;datetime.datetime.now().strftime(<span class="hljs-string">&quot;%Y-%m-%d&quot;</span>)&#125;</span>&#x27;</span><br>    key_updated = <span class="hljs-literal">False</span><br><br>    <span class="hljs-comment"># Check if .env file exists and read the content</span><br>    <span class="hljs-keyword">if</span> os.path.exists(env_file_path):<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(env_file_path, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>            lines = file.readlines()<br><br>        <span class="hljs-comment"># Update or add SECRET_KEY and LAST_UPDATED</span><br>        <span class="hljs-keyword">for</span> i, line <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(lines):<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;LAST_UPDATED&#x27;</span> <span class="hljs-keyword">in</span> line:<br>                last_updated_date = line.strip().split(<span class="hljs-string">&#x27;=&#x27;</span>)[<span class="hljs-number">1</span>]<br>                <span class="hljs-keyword">if</span> last_updated_date != datetime.datetime.now().strftime(<span class="hljs-string">&quot;%Y-%m-%d&quot;</span>):<br>                    lines[i] = last_updated + <span class="hljs-string">&#x27;\n&#x27;</span><br>                    key_updated = <span class="hljs-literal">True</span><br>            <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;SECRET_KEY&#x27;</span> <span class="hljs-keyword">in</span> line:<br>                <span class="hljs-keyword">if</span> key_updated <span class="hljs-keyword">is</span> <span class="hljs-literal">True</span>:<br>                    lines[i] = secret_key + <span class="hljs-string">&#x27;\n&#x27;</span><br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;no need to update the secret key today&quot;</span>)<br>                key_updated = <span class="hljs-literal">True</span><br><br>        <span class="hljs-comment"># If SECRET_KEY or LAST_UPDATED are not found, add them</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> key_updated:<br>            lines.append(last_updated + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>            lines.append(secret_key + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>            key_updated = <span class="hljs-literal">True</span><br><br>        <span class="hljs-comment"># Write back to .env file</span><br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(env_file_path, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>            file.writelines(lines)<br><br>    <span class="hljs-keyword">else</span>: <span class="hljs-comment"># If .env file doesn&#x27;t exist, create one</span><br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(env_file_path, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>            file.writelines([last_updated + <span class="hljs-string">&#x27;\n&#x27;</span>, secret_key + <span class="hljs-string">&#x27;\n&#x27;</span>])<br>        key_updated = <span class="hljs-literal">True</span><br><br>    <span class="hljs-keyword">if</span> key_updated:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Secret key and last updated date added/updated in .env file.&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;No update required for today.&quot;</span>)<br><br></code></pre></td></tr></table></figure>
<ol>
<li><strong>Visitor Count Feature</strong>:<ul>
<li>As part of the user experience, a visitor count is maintained, which is updated with each visit.</li>
</ul>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">update_visit_count</span>():<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;visit_count.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> file:<br>            count = <span class="hljs-built_in">int</span>(file.read())<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;visit_count.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> file:<br>            count += <span class="hljs-number">1</span><br>            file.write(<span class="hljs-built_in">str</span>(count))<br>        <span class="hljs-keyword">return</span> count<br>    <span class="hljs-keyword">except</span> IOError:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Error&quot;</span><br></code></pre></td></tr></table></figure>
<p>This implementation of JWT in a Flask application exemplifies a secure and efficient way of handling user authentication, ensuring that only authorized users can access protected services.</p>
<p><img src="https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20240127161720.png" alt="image.png"></p>
<h3 id="Designing-a-User-Friendly-Frontend"><a href="#Designing-a-User-Friendly-Frontend" class="headerlink" title="Designing a User-Friendly Frontend"></a>Designing a User-Friendly Frontend</h3><p>In tandem with robust backend security, the frontend of your web service plays a crucial role in user engagement and satisfaction. Let’s delve into the key features of our project’s frontend design:</p>
<p><strong>Theme Toggle and Slogan</strong>:</p>
<ul>
<li>The theme switcher allows users to choose between dark and light modes.</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;theme-switch-wrapper&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;theme-toggle&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;theme-toggle&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;moon&quot;</span>&gt;</span><span class="hljs-symbol">&amp;#9790;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;sun&quot;</span>&gt;</span><span class="hljs-symbol">&amp;#9728;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure>
<ul>
<li>A catchy slogan is displayed, setting a creative and visionary tone.</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;slogan&quot;</span>&gt;</span>Crafting Tomorrow&#x27;s Narratives, Today.<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p><strong>Login Interface</strong>:<br>The entry point of any web service, the login page, is where security meets user experience. Our Flask-based web application presents a clean and intuitive login interface. It includes fields for username and password and a login button. This simplicity ensures ease of use while maintaining a professional appearance.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;/login&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;email&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;Username&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">required</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;Password&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">required</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span>&gt;</span>Login<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br></code></pre></td></tr></table></figure>
<ul>
<li>Additional subtitle for contextual information.</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;subtitle&quot;</span>&gt;</span>If you want to reach this server, please contact Aiken or Metis.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p><strong>Interactive Error Handling</strong>:</p>
<ul>
<li>A unique error message display using a cat image, adding a touch of humor.</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs html">&#123;% if error %&#125;<br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;error-cat&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;&#123;&#123; url_for(&#x27;static&#x27;, filename=&#x27;images/cat.webp&#x27;) &#125;&#125;&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;Cat&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;speech-bubble&quot;</span>&gt;</span>&#123;&#123; error &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>&#123;% endif %&#125;<br></code></pre></td></tr></table></figure>
<p><strong>Footer with Visitor Count</strong>:</p>
<ul>
<li>Displaying the visitor count adds an interactive and transparent element.</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">footer</span>&gt;</span><br>    This page has been visited &#123;&#123; count &#125;&#125; times.<br><span class="hljs-tag">&lt;/<span class="hljs-name">footer</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p><img src="https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20240127161058.png" alt="image.png"></p>
<h3 id="Comparing-Authentication-Methods-JWT-OAuth-and-Basic-Authentication"><a href="#Comparing-Authentication-Methods-JWT-OAuth-and-Basic-Authentication" class="headerlink" title="Comparing Authentication Methods: JWT, OAuth, and Basic Authentication"></a>Comparing Authentication Methods: JWT, OAuth, and Basic Authentication</h3><p>In the realm of web security, selecting the right authentication method is crucial. Let’s compare JWT (JSON Web Tokens), OAuth, and Basic Authentication to understand their unique features and use cases:</p>
<ol>
<li><p><strong>JWT (JSON Web Tokens)</strong>:</p>
<ul>
<li><strong>Mechanism</strong>: Encoded tokens that carry claims and are used for secure data exchange.</li>
<li><strong>Use Cases</strong>: Ideal for single sign-on (SSO) and stateless applications.</li>
<li><strong>Pros</strong>: Highly flexible, supports cross-domain requests, and is self-contained with payload data.</li>
<li><strong>Cons</strong>: Requires careful management of secret keys and token expiration.</li>
</ul>
</li>
<li><p><strong>OAuth</strong>:</p>
<ul>
<li><strong>Mechanism</strong>: An authorization framework allowing applications to secure designated access without revealing user credentials.</li>
<li><strong>Use Cases</strong>: Best for third-party access (like social logins) and granting limited access to user data.</li>
<li><strong>Pros</strong>: Enhanced security as user credentials are not exposed, and allows token-based access control.</li>
<li><strong>Cons</strong>: Complex implementation and requires understanding of tokens and scopes.</li>
</ul>
</li>
<li><p><strong>Basic Authentication</strong>:</p>
<ul>
<li><strong>Mechanism</strong>: A simple authentication scheme built into the HTTP protocol using username and password.</li>
<li><strong>Use Cases</strong>: Suitable for simple login needs, especially when accessing APIs for internal use.</li>
<li><strong>Pros</strong>: Easy to implement and understand.</li>
<li><strong>Cons</strong>: Less secure as it sends credentials in base64 encoded format, vulnerable to interception.</li>
</ul>
</li>
</ol>
<p>Each of these methods has its strengths and weaknesses, and the choice largely depends on the specific requirements of your web application.</p>
<h3 id="Conclusion-Balancing-Security-and-User-Experience-in-Web-Services"><a href="#Conclusion-Balancing-Security-and-User-Experience-in-Web-Services" class="headerlink" title="Conclusion: Balancing Security and User Experience in Web Services"></a>Conclusion: Balancing Security and User Experience in Web Services</h3><p>As we conclude this journey through securing and personalizing web services, it’s clear that the right blend of backend security and frontend design can significantly enhance both the security and user experience of a web application.</p>
<p>From implementing robust JWT authentication in a Flask application to designing an engaging and intuitive frontend, each aspect plays a pivotal role in delivering a seamless and secure user experience. Whether it’s the compact and scalable nature of JWTs, the interactive and user-friendly design elements on the frontend, or the comparative analysis of different authentication methods, each component contributes to a comprehensive web service solution.</p>
<p>For small projects, especially, the choice of JWT stands out for its efficiency, scalability, and ease of implementation, making it a wise choice for developers looking to secure their applications without compromising on performance or user experience.</p>
<p>In the end, the key takeaway is that security and usability do not have to be at odds; with the right tools and approaches, they can complement each other to create web services that are not only secure but also enjoyable to use.</p>
<p>We encourage our readers to explore the code and concepts discussed in this blog post and to visit the GitHub repository for the original code at <a target="_blank" rel="noopener" href="https://github.com/AikenH/ezEncryptYourService?tab=readme-ov-file">ezEncryptYourService</a>. Dive in, experiment, and elevate your web services to new heights of security and user engagement.</p>
<p><strong>Meta Title:</strong> Secure and Personalize Your Web Services: A Comprehensive Guide</p>
<p><strong>Meta Description:</strong> Dive into our latest blog post where we explore how to balance robust security with engaging user experience in web services, featuring JWT, Flask, and innovative frontend designs.](&lt;%3E [!summary]+</p>
<blockquote>
<p>this article purpose is to build an authority page for stable diffusion webui using nginx &amp; python/js. Which can publish my personal stable diffusion server.</p>
</blockquote>
<p><img src="https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20240127161828.png" alt="image.png"></p>
<h3 id="Introduction-1"><a href="#Introduction-1" class="headerlink" title="Introduction"></a>Introduction</h3><p>In the digital age, the security and user-friendliness of web services are not just conveniences; they are necessities. Balancing robust security protocols with an engaging user experience is key to maintaining both the integrity and popularity of any online service. This blog post dives into the intricacies of securing web services using Nginx for authentication, coupled with designing an appealing frontend. Our journey begins with a practical scenario: publishing a stable diffusion webUI service, accessible only to an authenticated audience.</p>
<h3 id="Setting-Up-Nginx-for-Secure-Authentication-1"><a href="#Setting-Up-Nginx-for-Secure-Authentication-1" class="headerlink" title="Setting Up Nginx for Secure Authentication"></a>Setting Up Nginx for Secure Authentication</h3><p>Nginx excels in serving web pages and as a reverse proxy, providing enhanced security through authentication mechanisms. Let’s explore a typical Nginx configuration for secure authentication:</p>
<ul>
<li><strong>/verify_token</strong>: This block forwards authentication requests to a dedicated server. By excluding the request body and focusing on essential headers, it ensures that only valid, authenticated requests proceed.</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs conf">location = /verify_token &#123;<br>    proxy_pass http://&#123;your_auth_server&#125;:2424;<br>    proxy_pass_request_body off;<br>    proxy_set_header Content-Length &quot;&quot;;<br>    proxy_set_header X-Original-URI $request_uri;<br>    proxy_set_header X-Original-Remote-Addr $remote_addr;<br>    proxy_set_header X-Original-Host $host;<br>&#125;<br></code></pre></td></tr></table></figure>
<ul>
<li><strong>/login</strong>: Catering to login requests, this configuration forwards the necessary details to the authentication server, preserving crucial information about the request’s origin.</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs conf">location /login &#123;<br>    proxy_pass http://&#123;your_auth_server&#125;:2424;<br>    proxy_set_header Host $host;<br>    proxy_set_header X-Real-IP $remote_addr;<br>    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;<br>    proxy_set_header X-Forwarded-Proto $scheme;<br>&#125;<br></code></pre></td></tr></table></figure>
<ul>
<li><strong>Error Handling (@error401)</strong>: A clever redirect mechanism that guides unauthenticated users to the login page, keeping the original URL intact.</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs conf">location @error401 &#123;<br>    return 302 &#123;your_domain&#125;/login;<br>&#125;<br></code></pre></td></tr></table></figure>
<ul>
<li><strong>Root Location (/)</strong>: The gateway to your service, which rigorously checks each request for authentication, granting access only to verified users.</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs conf">location / &#123;<br>    auth_request /verify_token;<br>    error_page 401 = @error401;<br>    proxy_pass http://&#123;your_server&#125;:2323/;<br>    proxy_http_version 1.1;<br>    proxy_set_header Upgrade $http_upgrade;<br>    proxy_set_header Connection &#x27;upgrade&#x27;;<br>    proxy_set_header Host $host;<br>    proxy_cache_bypass $http_upgrade;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>This setup not only fortifies your service against unauthorized access but also maintains a seamless user experience, redirecting unauthenticated users without hassle.</p>
<h3 id="Implementing-JWT-for-Robust-Backend-Authentication-1"><a href="#Implementing-JWT-for-Robust-Backend-Authentication-1" class="headerlink" title="Implementing JWT for Robust Backend Authentication"></a>Implementing JWT for Robust Backend Authentication</h3><p>Implementing JWT (JSON Web Tokens) in a Flask web application provides a secure way of handling authentication. The provided Flask code demonstrates how JWT can be integrated for a robust backend authentication system:</p>
<ol>
<li><strong>Setup and Environment Variables</strong>:<ul>
<li>The Flask app is configured with a secret key, essential for JWT encoding and decoding.</li>
</ul>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> dotenv <span class="hljs-keyword">import</span> load_dotenv<br><br>load_dotenv()<br>app = Flask(__name__)<br>app.secret_key = os.getenv(<span class="hljs-string">&#x27;SECRET_KEY&#x27;</span>)<br></code></pre></td></tr></table></figure>
<ol>
<li><strong>Login Route</strong>:<ul>
<li>The <code>/login</code> route handles user authentication. Upon successful login, a JWT is encoded with the user’s information and expiration time, then sent as a cookie.</li>
</ul>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/login&#x27;</span>, methods=[<span class="hljs-string">&#x27;POST&#x27;</span>, <span class="hljs-string">&#x27;GET&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">login</span>():<br>    count = update_visit_count()<br>    <span class="hljs-keyword">if</span> request.method == <span class="hljs-string">&#x27;POST&#x27;</span>:<br>        username = request.form[<span class="hljs-string">&#x27;username&#x27;</span>]<br>        password = request.form[<span class="hljs-string">&#x27;password&#x27;</span>]<br><br>        <span class="hljs-comment"># Validate credentials (use a secure method in production)</span><br>        <span class="hljs-keyword">if</span> username == os.getenv(<span class="hljs-string">&#x27;chat_username&#x27;</span>) <span class="hljs-keyword">and</span> password == os.getenv(<span class="hljs-string">&#x27;password&#x27;</span>):<br>            token = jwt.encode(&#123;<br>                <span class="hljs-string">&#x27;user&#x27;</span>: username,<br>                <span class="hljs-string">&#x27;exp&#x27;</span>: datetime.datetime.utcnow() + datetime.timedelta(minutes=<span class="hljs-number">30</span>)<br>            &#125;, app.secret_key, algorithm=<span class="hljs-string">&#x27;HS256&#x27;</span>)<br><br>            response = make_response(redirect(<span class="hljs-string">&#x27;/&#x27;</span>))<br>            response.set_cookie(<span class="hljs-string">&#x27;token&#x27;</span>, token, max_age=<span class="hljs-number">1800</span>)  <span class="hljs-comment"># Keep login status for 30 mins</span><br>            <span class="hljs-keyword">return</span> response<br>        <br>        error = <span class="hljs-string">&#x27;Invalid credentials&#x27;</span><br>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;login.html&#x27;</span>, error=error, count=count), <span class="hljs-number">401</span><br>    <br>    <span class="hljs-comment"># Show login page</span><br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;login.html&#x27;</span>,count=count)<br></code></pre></td></tr></table></figure>
<ol>
<li><strong>Token Verification</strong>:<ul>
<li>A decorator <code>token_required</code> is used to verify the JWT token in subsequent requests. This ensures that only authenticated users can access certain routes.</li>
</ul>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">token_required</span>(<span class="hljs-params">f</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">decorator</span>(<span class="hljs-params">*args, **kwargs</span>):<br>        token = request.cookies.get(<span class="hljs-string">&#x27;token&#x27;</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> token:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;token is none&#x27;</span>)<br>            <span class="hljs-keyword">return</span> redirect(<span class="hljs-string">&#x27;/login&#x27;</span>)<br>        <span class="hljs-keyword">try</span>:<br>            jwt.decode(token, app.secret_key, algorithms=[<span class="hljs-string">&#x27;HS256&#x27;</span>])<br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;token is invalid&#x27;</span>)<br>            <span class="hljs-keyword">return</span> redirect(<span class="hljs-string">&#x27;/login&#x27;</span>)<br>        <span class="hljs-keyword">return</span> f(*args, **kwargs)<br>    decorator.__name__ = f.__name__<br>    <span class="hljs-keyword">return</span> decorator<br></code></pre></td></tr></table></figure>
<ol>
<li><strong>Token Validation Endpoint</strong>:<ul>
<li>The <code>/verify_token</code> endpoint checks the validity of the token, which is essential for integrating with the Nginx authentication mechanism.</li>
</ul>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/verify_token&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">verify_token</span>():<br>    token = request.cookies.get(<span class="hljs-string">&#x27;token&#x27;</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> token:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Access Denied&#x27;</span>, <span class="hljs-number">401</span><br><br>    <span class="hljs-keyword">try</span>:<br>        jwt.decode(token, app.secret_key, algorithms=[<span class="hljs-string">&#x27;HS256&#x27;</span>])<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Authorized&#x27;</span>, <span class="hljs-number">200</span><br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Access Denied&#x27;</span>, <span class="hljs-number">401</span><br></code></pre></td></tr></table></figure>
<ol>
<li><strong>Dynamic Secret Key Update</strong>:<ul>
<li>A function <code>update_secret_key_in_env</code> is included to update the secret key daily, enhancing security by invalidating old tokens.</li>
</ul>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Function to generate a new secret key and write it to the .env file</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">update_secret_key_in_env</span>():<br>    env_file_path = <span class="hljs-string">&#x27;.env&#x27;</span><br>    secret_key = <span class="hljs-string">f&#x27;SECRET_KEY=<span class="hljs-subst">&#123;secrets.token_urlsafe(<span class="hljs-number">32</span>)&#125;</span>&#x27;</span><br>    last_updated = <span class="hljs-string">f&#x27;LAST_UPDATED=<span class="hljs-subst">&#123;datetime.datetime.now().strftime(<span class="hljs-string">&quot;%Y-%m-%d&quot;</span>)&#125;</span>&#x27;</span><br>    key_updated = <span class="hljs-literal">False</span><br><br>    <span class="hljs-comment"># Check if .env file exists and read the content</span><br>    <span class="hljs-keyword">if</span> os.path.exists(env_file_path):<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(env_file_path, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>            lines = file.readlines()<br><br>        <span class="hljs-comment"># Update or add SECRET_KEY and LAST_UPDATED</span><br>        <span class="hljs-keyword">for</span> i, line <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(lines):<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;LAST_UPDATED&#x27;</span> <span class="hljs-keyword">in</span> line:<br>                last_updated_date = line.strip().split(<span class="hljs-string">&#x27;=&#x27;</span>)[<span class="hljs-number">1</span>]<br>                <span class="hljs-keyword">if</span> last_updated_date != datetime.datetime.now().strftime(<span class="hljs-string">&quot;%Y-%m-%d&quot;</span>):<br>                    lines[i] = last_updated + <span class="hljs-string">&#x27;\n&#x27;</span><br>                    key_updated = <span class="hljs-literal">True</span><br>            <span class="hljs-keyword">elif</span> <span class="hljs-string">&#x27;SECRET_KEY&#x27;</span> <span class="hljs-keyword">in</span> line:<br>                <span class="hljs-keyword">if</span> key_updated <span class="hljs-keyword">is</span> <span class="hljs-literal">True</span>:<br>                    lines[i] = secret_key + <span class="hljs-string">&#x27;\n&#x27;</span><br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;no need to update the secret key today&quot;</span>)<br>                key_updated = <span class="hljs-literal">True</span><br><br>        <span class="hljs-comment"># If SECRET_KEY or LAST_UPDATED are not found, add them</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> key_updated:<br>            lines.append(last_updated + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>            lines.append(secret_key + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>            key_updated = <span class="hljs-literal">True</span><br><br>        <span class="hljs-comment"># Write back to .env file</span><br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(env_file_path, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>            file.writelines(lines)<br><br>    <span class="hljs-keyword">else</span>: <span class="hljs-comment"># If .env file doesn&#x27;t exist, create one</span><br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(env_file_path, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>            file.writelines([last_updated + <span class="hljs-string">&#x27;\n&#x27;</span>, secret_key + <span class="hljs-string">&#x27;\n&#x27;</span>])<br>        key_updated = <span class="hljs-literal">True</span><br><br>    <span class="hljs-keyword">if</span> key_updated:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Secret key and last updated date added/updated in .env file.&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;No update required for today.&quot;</span>)<br><br></code></pre></td></tr></table></figure>
<ol>
<li><strong>Visitor Count Feature</strong>:<ul>
<li>As part of the user experience, a visitor count is maintained, which is updated with each visit.</li>
</ul>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">update_visit_count</span>():<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;visit_count.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> file:<br>            count = <span class="hljs-built_in">int</span>(file.read())<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;visit_count.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> file:<br>            count += <span class="hljs-number">1</span><br>            file.write(<span class="hljs-built_in">str</span>(count))<br>        <span class="hljs-keyword">return</span> count<br>    <span class="hljs-keyword">except</span> IOError:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Error&quot;</span><br></code></pre></td></tr></table></figure>
<p>This implementation of JWT in a Flask application exemplifies a secure and efficient way of handling user authentication, ensuring that only authorized users can access protected services.</p>
<p><img src="https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20240127161720.png" alt="image.png"></p>
<h3 id="Designing-a-User-Friendly-Frontend-1"><a href="#Designing-a-User-Friendly-Frontend-1" class="headerlink" title="Designing a User-Friendly Frontend"></a>Designing a User-Friendly Frontend</h3><p>In tandem with robust backend security, the frontend of your web service plays a crucial role in user engagement and satisfaction. Let’s delve into the key features of our project’s frontend design:</p>
<p><strong>Theme Toggle and Slogan</strong>:</p>
<ul>
<li>The theme switcher allows users to choose between dark and light modes.</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs html">%3Cdiv class=&quot;theme-switch-wrapper&quot;&gt;<br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;theme-toggle&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;theme-toggle&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;moon&quot;</span>&gt;</span><span class="hljs-symbol">&amp;#9790;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;sun&quot;</span>&gt;</span><span class="hljs-symbol">&amp;#9728;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure>
<ul>
<li>A catchy slogan is displayed, setting a creative and visionary tone.</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;slogan&quot;</span>&gt;</span>Crafting Tomorrow&#x27;s Narratives, Today.<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p><strong>Login Interface</strong>:<br>The entry point of any web service, the login page, is where security meets user experience. Our Flask-based web application presents a clean and intuitive login interface. It includes fields for username and password and a login button. This simplicity ensures ease of use while maintaining a professional appearance.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;/login&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;email&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;Username&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span> <span class="hljs-attr">required</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">&quot;Password&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span> <span class="hljs-attr">required</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span>&gt;</span>Login<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br></code></pre></td></tr></table></figure>
<ul>
<li>Additional subtitle for contextual information.</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;subtitle&quot;</span>&gt;</span>If you want to reach this server, please contact Aiken or Metis.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p><strong>Interactive Error Handling</strong>:</p>
<ul>
<li>A unique error message display using a cat image, adding a touch of humor.</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs html">&#123;% if error %&#125;<br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;error-cat&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;&#123;&#123; url_for(&#x27;static&#x27;, filename=&#x27;images/cat.webp&#x27;) &#125;&#125;&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;Cat&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;speech-bubble&quot;</span>&gt;</span>&#123;&#123; error &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>&#123;% endif %&#125;<br></code></pre></td></tr></table></figure>
<p><strong>Footer with Visitor Count</strong>:</p>
<ul>
<li>Displaying the visitor count adds an interactive and transparent element.</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">footer</span>&gt;</span><br>    This page has been visited &#123;&#123; count &#125;&#125; times.<br><span class="hljs-tag">&lt;/<span class="hljs-name">footer</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p><img src="https://picture-bed-001-1310572365.cos.ap-guangzhou.myqcloud.com/3070PC/20240127161058.png" alt="image.png"></p>
<h3 id="Comparing-Authentication-Methods-JWT-OAuth-and-Basic-Authentication-1"><a href="#Comparing-Authentication-Methods-JWT-OAuth-and-Basic-Authentication-1" class="headerlink" title="Comparing Authentication Methods: JWT, OAuth, and Basic Authentication"></a>Comparing Authentication Methods: JWT, OAuth, and Basic Authentication</h3><p>In the realm of web security, selecting the right authentication method is crucial. Let’s compare JWT (JSON Web Tokens), OAuth, and Basic Authentication to understand their unique features and use cases:</p>
<ol>
<li><p><strong>JWT (JSON Web Tokens)</strong>:</p>
<ul>
<li><strong>Mechanism</strong>: Encoded tokens that carry claims and are used for secure data exchange.</li>
<li><strong>Use Cases</strong>: Ideal for single sign-on (SSO) and stateless applications.</li>
<li><strong>Pros</strong>: Highly flexible, supports cross-domain requests, and is self-contained with payload data.</li>
<li><strong>Cons</strong>: Requires careful management of secret keys and token expiration.</li>
</ul>
</li>
<li><p><strong>OAuth</strong>:</p>
<ul>
<li><strong>Mechanism</strong>: An authorization framework allowing applications to secure designated access without revealing user credentials.</li>
<li><strong>Use Cases</strong>: Best for third-party access (like social logins) and granting limited access to user data.</li>
<li><strong>Pros</strong>: Enhanced security as user credentials are not exposed, and allows token-based access control.</li>
<li><strong>Cons</strong>: Complex implementation and requires understanding of tokens and scopes.</li>
</ul>
</li>
<li><p><strong>Basic Authentication</strong>:</p>
<ul>
<li><strong>Mechanism</strong>: A simple authentication scheme built into the HTTP protocol using username and password.</li>
<li><strong>Use Cases</strong>: Suitable for simple login needs, especially when accessing APIs for internal use.</li>
<li><strong>Pros</strong>: Easy to implement and understand.</li>
<li><strong>Cons</strong>: Less secure as it sends credentials in base64 encoded format, vulnerable to interception.</li>
</ul>
</li>
</ol>
<p>Each of these methods has its strengths and weaknesses, and the choice largely depends on the specific requirements of your web application.</p>
<h3 id="Conclusion-Balancing-Security-and-User-Experience-in-Web-Services-1"><a href="#Conclusion-Balancing-Security-and-User-Experience-in-Web-Services-1" class="headerlink" title="Conclusion: Balancing Security and User Experience in Web Services"></a>Conclusion: Balancing Security and User Experience in Web Services</h3><p>As we conclude this journey through securing and personalizing web services, it’s clear that the right blend of backend security and frontend design can significantly enhance both the security and user experience of a web application.</p>
<p>From implementing robust JWT authentication in a Flask application to designing an engaging and intuitive frontend, each aspect plays a pivotal role in delivering a seamless and secure user experience. Whether it’s the compact and scalable nature of JWTs, the interactive and user-friendly design elements on the frontend, or the comparative analysis of different authentication methods, each component contributes to a comprehensive web service solution.</p>
<p>For small projects, especially, the choice of JWT stands out for its efficiency, scalability, and ease of implementation, making it a wise choice for developers looking to secure their applications without compromising on performance or user experience.</p>
<p>In the end, the key takeaway is that security and usability do not have to be at odds; with the right tools and approaches, they can complement each other to create web services that are not only secure but also enjoyable to use.</p>
<p>We encourage our readers to explore the code and concepts discussed in this blog post and to visit the GitHub repository for the original code at <a target="_blank" rel="noopener" href="https://github.com/AikenH/ezEncryptYourService?tab=readme-ov-file">ezEncryptYourService</a>. Dive in, experiment, and elevate your web services to new heights of security and user engagement.</p>
<p><strong>Meta Title:</strong> Secure and Personalize Your Web Services: A Comprehensive Guide</p>
<p><strong>Meta Description:</strong> Dive into our latest blog post where we explore how to balance robust security with engaging user experience in web services, featuring JWT, Flask, and innovative frontend designs.&gt;)</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>StableDiffusionWebUI鉴权设计</p><p><a href="http://aikenh.cn/cn/StableDiffusionWebUI鉴权设计/">http://aikenh.cn/cn/StableDiffusionWebUI鉴权设计/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>AikenH</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2023-12-08</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2024-01-27</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><hr style="height:1px;margin:1rem 0"><div class="level is-mobile is-flex"><div class="article-tags is-size-7 is-uppercase"><i class="fas fa-tags has-text-grey"></i> <a class="link-muted" rel="tag" href="/tags/AI/">AI, </a><a class="link-muted" rel="tag" href="/tags/AIGC/">AIGC, </a><a class="link-muted" rel="tag" href="/tags/Web/">Web, </a><a class="link-muted" rel="tag" href="/tags/Flask/">Flask </a></div></div><!--!--></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>Alipay</span><span class="qrcode"><img src="/img/alipay.jpg" alt="Alipay"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="/img/wechat.jpg" alt="Wechat"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/cn/%E5%AE%B6%E5%BA%AD%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%95%B4%E4%BD%93%E6%96%B9%E6%A1%88/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">家庭服务器整体方案</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/cn/%E6%A0%91%E8%8E%93%E6%B4%BE%E5%AE%B6%E5%BA%AD%E5%BD%B1%E9%9F%B3%E4%B8%AD%E5%BF%832/"><span class="level-item">树莓派家庭影音中心2</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config = function () {
            this.page.url = 'http://aikenh.cn/cn/StableDiffusionWebUI%E9%89%B4%E6%9D%83%E8%AE%BE%E8%AE%A1/';
            this.page.identifier = 'cn/StableDiffusionWebUI鉴权设计/';
        };
        (function() {
            var d = document, s = d.createElement('script');  
            s.src = '//' + 'my-tech-blog-3' + '.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/title.jpg" alt="AikenH"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">AikenH</p><p class="is-size-6 is-block">Future Full-Stack Developer</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>ShenZhen</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">137</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">42</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">102</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/AikenH" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="ZhiHu" href="https://www.zhihu.com/people/Aiken-h"><i class="fab fa-zhihu"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Weibo" href="https://weibo.com/u/1788200627"><i class="fab fa-weibo"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Steam" href="https://steamcommunity.com/id/AikenH/"><i class="fab fa-steam"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/AikenH"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Introduction"><span class="level-left"><span class="level-item">1</span><span class="level-item">Introduction</span></span></a></li><li><a class="level is-mobile" href="#Setting-Up-Nginx-for-Secure-Authentication"><span class="level-left"><span class="level-item">2</span><span class="level-item">Setting Up Nginx for Secure Authentication</span></span></a></li><li><a class="level is-mobile" href="#Implementing-JWT-for-Robust-Backend-Authentication"><span class="level-left"><span class="level-item">3</span><span class="level-item">Implementing JWT for Robust Backend Authentication</span></span></a></li><li><a class="level is-mobile" href="#Designing-a-User-Friendly-Frontend"><span class="level-left"><span class="level-item">4</span><span class="level-item">Designing a User-Friendly Frontend</span></span></a></li><li><a class="level is-mobile" href="#Comparing-Authentication-Methods-JWT-OAuth-and-Basic-Authentication"><span class="level-left"><span class="level-item">5</span><span class="level-item">Comparing Authentication Methods: JWT, OAuth, and Basic Authentication</span></span></a></li><li><a class="level is-mobile" href="#Conclusion-Balancing-Security-and-User-Experience-in-Web-Services"><span class="level-left"><span class="level-item">6</span><span class="level-item">Conclusion: Balancing Security and User Experience in Web Services</span></span></a></li><li><a class="level is-mobile" href="#Introduction-1"><span class="level-left"><span class="level-item">7</span><span class="level-item">Introduction</span></span></a></li><li><a class="level is-mobile" href="#Setting-Up-Nginx-for-Secure-Authentication-1"><span class="level-left"><span class="level-item">8</span><span class="level-item">Setting Up Nginx for Secure Authentication</span></span></a></li><li><a class="level is-mobile" href="#Implementing-JWT-for-Robust-Backend-Authentication-1"><span class="level-left"><span class="level-item">9</span><span class="level-item">Implementing JWT for Robust Backend Authentication</span></span></a></li><li><a class="level is-mobile" href="#Designing-a-User-Friendly-Frontend-1"><span class="level-left"><span class="level-item">10</span><span class="level-item">Designing a User-Friendly Frontend</span></span></a></li><li><a class="level is-mobile" href="#Comparing-Authentication-Methods-JWT-OAuth-and-Basic-Authentication-1"><span class="level-left"><span class="level-item">11</span><span class="level-item">Comparing Authentication Methods: JWT, OAuth, and Basic Authentication</span></span></a></li><li><a class="level is-mobile" href="#Conclusion-Balancing-Security-and-User-Experience-in-Web-Services-1"><span class="level-left"><span class="level-item">12</span><span class="level-item">Conclusion: Balancing Security and User Experience in Web Services</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><figure class="media-left"><a class="image" href="/cn/BackupToolsForHomeServer/"><img src="/img/header_img/lml_bg1.jpg" alt="家庭服务器的备份工具选择"></a></figure><div class="media-content"><p class="date"><time dateTime="2023-12-29T00:04:06.000Z">2023-12-29</time></p><p class="title"><a href="/cn/BackupToolsForHomeServer/">家庭服务器的备份工具选择</a></p><p class="categories"><a href="/categories/NAS/">NAS</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/cn/%E5%AE%B6%E5%BA%AD%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%95%B4%E4%BD%93%E6%96%B9%E6%A1%88/"><img src="/img/header_img/lml_bg1.jpg" alt="家庭服务器整体方案"></a></figure><div class="media-content"><p class="date"><time dateTime="2023-12-20T00:24:36.000Z">2023-12-20</time></p><p class="title"><a href="/cn/%E5%AE%B6%E5%BA%AD%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%95%B4%E4%BD%93%E6%96%B9%E6%A1%88/">家庭服务器整体方案</a></p><p class="categories"><a href="/categories/NAS/">NAS</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/cn/StableDiffusionWebUI%E9%89%B4%E6%9D%83%E8%AE%BE%E8%AE%A1/"><img src="/img/header_img/lml_bg1.jpg" alt="StableDiffusionWebUI鉴权设计"></a></figure><div class="media-content"><p class="date"><time dateTime="2023-12-08T07:42:36.000Z">2023-12-08</time></p><p class="title"><a href="/cn/StableDiffusionWebUI%E9%89%B4%E6%9D%83%E8%AE%BE%E8%AE%A1/">StableDiffusionWebUI鉴权设计</a></p><p class="categories"><a href="/categories/Machine-Learning/">Machine Learning</a> / <a href="/categories/Machine-Learning/AIGC/">AIGC</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/cn/%E6%A0%91%E8%8E%93%E6%B4%BE%E5%AE%B6%E5%BA%AD%E5%BD%B1%E9%9F%B3%E4%B8%AD%E5%BF%832/"><img src="/img/header_img/lml_bg1.jpg" alt="树莓派家庭影音中心2"></a></figure><div class="media-content"><p class="date"><time dateTime="2023-11-11T04:08:37.000Z">2023-11-11</time></p><p class="title"><a href="/cn/%E6%A0%91%E8%8E%93%E6%B4%BE%E5%AE%B6%E5%BA%AD%E5%BD%B1%E9%9F%B3%E4%B8%AD%E5%BF%832/">树莓派家庭影音中心2</a></p><p class="categories"><a href="/categories/Dev/">Dev</a> / <a href="/categories/Dev/Raspberry-pie/">Raspberry-pie</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/cn/emby_localhost_crack_by_nginx/"><img src="/img/header_img/lml_bg2.jpg" alt="破解本地自托管Emby服务"></a></figure><div class="media-content"><p class="date"><time dateTime="2023-11-10T06:05:15.000Z">2023-11-10</time></p><p class="title"><a href="/cn/emby_localhost_crack_by_nginx/">破解本地自托管Emby服务</a></p><p class="categories"><a href="/categories/NAS/">NAS</a></p></div></article></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">Aiken&#039;s Blog</a><p class="is-size-7"><span>&copy; 2024 AikenH</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_pv">Visited by <span id="busuanzi_value_site_uv">0</span> users</span> and <span id="busuanzi_container2_site_uv"><span id="busuanzi_value_site_pv">0</span>&nbsp;visits</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><script src="/js/night.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>